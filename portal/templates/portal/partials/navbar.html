{% load staticfiles %}
{% load app_tags %}
{% load hijack_tags %}

<div class="header">
    <a class="hidden-xs" href="{% url 'home' %}">
        <img class="logo" src="{% static 'portal/img/logo_cfl.png' %}">
    </a>
    <div class="menu">
        <div class="menu__brand">
            <a class="visible-xs" href="{% url 'home' %}">
                <img class="logo" src="{% static 'portal/img/logo_cfl.png' %}">
            </a>
            <a target="_blank" href="https://www.ocadogroup.com/technology/technology-pioneers">
                <img title="Proudly developed by Ocado Technology" alt="Proudly developed by Ocado Group"
                src="{% static 'portal/img/logo_ocado_group.svg' %}">
            </a>
            <span class="glyphicon glyphicon-menu-hamburger header__hamburger visible-xs"
                  data-toggle="collapse" data-target="#menu-items"></span>
        </div>
        {% block leftMenuButtons %}
            {% if user|is_logged_in %}
            <div class="menu__left-side col-sm-7">
                {% if user|is_logged_in_as_teacher %}
                    <a href="{% url 'teach' %}" class="button--menu button--menu--primary"><b>Teacher</b></a>
                    {% block secondaryButtons %}
                    {% if user|has_teacher_finished_onboarding %}
                        {% block dashboard %}<a href="{% url 'dashboard' %}" class="button--menu button--menu--secondary button--menu--enabled">School / Club</a>{% endblock dashboard %}
                        {% block rapidrouter %}<a href="{% url 'levels' %}" class="button--menu button--menu--secondary button--menu--enabled">Rapid Router</a>{% endblock rapidrouter %}
                        {% block aimmo %}
                            <a href="{% url_for_aimmo_dashboard %}" id="teacher_kurono_dashboard_button"
                              class="button--menu button--menu--secondary button--menu--enabled">Kurono</a>
                        {% endblock aimmo %}
                        <div class="dropdown">
                            {% block materials %}<a id="teaching_resources_button"
                                class="button--menu button--menu--secondary button--menu--enabled">
                                Teaching Resources <span class="material-icons-outlined md-32">arrow_drop_down</span></a>{% endblock materials %}
                            <div class="dropdown-content">
                                <a id="rapid_router_resources_button" href="{% url 'teaching_resources' %}">
                                    <small>Rapid Router</small></a>
                                <a id="kurono_resources_button" href="{% url 'kurono_teaching_resources' %}">
                                    <small>Kurono</small></a>
                            </div>
                        </div>
                    {% else %}
                        <a href="{% url 'onboarding-organisation' %}" class="button--menu button--menu--secondary button--menu--enabled">School / Club</a>
                        <a class="button--menu button--menu--secondary button--menu--disabled">Rapid Router</a>
                        <a class="button--menu button--menu--secondary button--menu--disabled">Kurono</a>
                        <a class="button--menu button--menu--secondary button--menu--disabled">Teaching Resources</a>
                    {% endif %}
                    {% endblock secondaryButtons %}
                {% else %}
                    <a href="{% url 'play' %}" class="button--menu button--menu--primary"><b>Student</b></a>
                    {% block studentButtons %}
                    <div class="dropdown">
                        {% block myGames %}<a href="{% url 'student_details' %}" id="student_dashboard_button"
                          class="button--menu button--menu--secondary button--menu--enabled">My Games</a>{% endblock myGames %}
                        <div class="dropdown-content">
                            <a href="{% url 'levels' %}"><small>Rapid Router</small></a>
                            {% if not user|is_independent_student %}
                                <a href="{% url_for_aimmo_dashboard %}"><small>Kurono</small></a>
                            {% endif %}
                        </div>
                    </div>
                    {% if user|is_logged_in_as_school_user %}
                    <div class="dropdown">
                        <a href="{% url 'scoreboard' %}" id="student_scoreboards_button"
                          class="button--menu button--menu--secondary button--menu--enabled">View Scoreboards</a>
                        <div class="dropdown-content">
                            <a href="{% url 'scoreboard' %}"><small>Rapid Router</small></a>
                        </div>
                    </div>
                    {% endif %}
                    {% if not user.new_student.class_field %}
                        <a href="{% url 'student_join_organisation' %}" id="student_join_school_button"
                          class="button--menu button--menu--secondary button--menu--enabled">Join a school</a>
                    {% endif %}
                    {% endblock studentButtons %}
                {% endif %}
            {% else %}
                <div class="menu__left-side col-sm-5">
                    {% block nav_teach %}<a href="{% url 'teach' %}" class="button--menu button--menu--primary button--menu--enabled">Teachers</a>{% endblock nav_teach %}
                    {% block nav_play %}<a href="{% url 'play' %}" class="button--menu button--menu--primary  button--menu--enabled">Students</a>{% endblock nav_play %}
            {% endif %}
            </div>
        {% endblock leftMenuButtons %}
        {% block rightMenuButtons %}
            {% if user|is_logged_in %}
            <div class="menu__right-side col-sm-4">
                <div class="dropdown header__account-details-dropdown">
                    <button id="logout_menu" class="button--regular button--secondary button--dropdown header__account-details-dropdown"
                            data-toggle="dropdown">
                        <div class="dropdown__text">{{ user|make_into_username }}</div>
                    </button>
                    <ul class="dropdown-menu header__account-details-dropdown-menu">
                        {% if not request|is_hijacked %}
                        <li class="dropdown-menu__option">
                            <a class="button--regular button--primary--navigation" id="logout_button" aria-labelledby="Log out"
                              href="{% url 'logout_view' %}" onclick="deleteAllLocalStorageWorkspaces();">
                                <small class="dropdown-menu__option__text">Log out</small>
                                <div class="glyphicon glyphicon-log-out"></div></a>
                        </li>
                        {% endif %}
                        {% if user|is_logged_in_as_teacher %}
                            <li class="dropdown-menu__option">
                                <a class="button--regular button--primary--navigation" aria-labelledby="Change password"
                                  href="{% url 'dashboard' %}#edit_account_details_password">
                                    <small class="dropdown-menu__option__text">Change password</small>
                                    <div class="glyphicon glyphicon-lock"></div></a>
                            </li>
                            <li class="dropdown-menu__option">
                                <a class="button--regular button--primary--navigation" aria-labelledby="Update my details"
                                  href="{% url 'dashboard' %}#account">
                                    <small class="dropdown-menu__option__text">Update my details</small>
                                    <div class="glyphicon glyphicon-user"></div></a>
                            </li>
                        {% else %}
                            <li class="dropdown-menu__option">
                                <a class="button--regular button--primary--navigation" aria-labelledby="Change password"
                                  href="{% url 'student_edit_account' %}" id="student_edit_account_button">
                                    <small class="dropdown-menu__option__text">Change password</small>
                                    <div class="glyphicon glyphicon-lock"></div></a>
                            </li>
                        {% endif %}
                    </ul>
                </div>
                {% else %}
                <div class="menu__right-side col-sm-5">
                    <a href="{% url 'register' %}" id="signup_button" class="button button--regular button--register register">Register</a>
                    <div class="dropdown">
                        <button id="login_dropdown" class="button--regular button--secondary login button--dropdown"
                                data-toggle="dropdown">
                            <div class="dropdown__text">Log in</div>
                        </button>
                        <ul class="dropdown-menu header__login-options-dropdown-menu">
                            <li class="dropdown-menu__option">
                                <a id="teacher_login_button" class="button--regular button--primary--general-play" aria-labelledby="Teacher" href="{% url 'teacher_login' %}">
                                    <small class="dropdown-menu__option__text">Teacher</small></a>
                            </li>
                            <li class="dropdown-menu__option">
                                <a id="student_login_button" class="button--regular button--primary--general-educate" aria-labelledby="Student" href="{% url 'student_login' %}">
                                    <small class="dropdown-menu__option__text">Student</small></a>
                            </li>
                            <li class="dropdown-menu__option">
                                <a id="independent_login_button" class="button--regular button--primary--negative" aria-labelledby="Independent" href="{% url 'independent_student_login' %}">
                                    <small class="dropdown-menu__option__text">Independent</small></a>
                            </li>
                        </ul>
                    </div>
                {% endif %}
            </div>
        {% endblock rightMenuButtons %}
    </div>
    <div id="menu-items" class="collapse">
        {% if user|is_logged_in %}
            <div class="menu__item">
                <h1>{{ user|make_into_username }}</h1>
            </div>
            {% if user|is_logged_in_as_teacher %}
                <button class="button--menu__item button--menu__item--sub-header"
                        data-toggle="collapse" data-target="#teacher-tabs">Teacher</button>
                <div id="teacher-tabs" class="collapse">
                    <a class="button button--menu__item button--menu__item--teacher button--menu__item__sub"
                      href="{% url 'dashboard' %}">School / Club<div class="glyphicon glyphicon-chevron-right"></div></a>
                    <a class="button button--menu__item button--menu__item--teacher button--menu__item__sub"
                      href="{% url 'levels' %}">Rapid Router<div class="glyphicon glyphicon-chevron-right"></div></a>
                    <button class="button--menu__item button--menu__item--teacher button--menu__item__sub
                    button--menu__item--sub-header" data-toggle="collapse" data-target="#resources-tabs">Teaching Resources</button>
                    <div id="resources-tabs" class="collapse">
                        <a class="button button--menu__item button--menu__item--teacher button--menu__item__sub__sub"
                          href="{% url 'teaching_resources' %}">Rapid Router<div class="glyphicon glyphicon-chevron-right"></div></a>
                        <a class="button button--menu__item button--menu__item--teacher button--menu__item__sub__sub"
                          href="{% url 'kurono_teaching_resources' %}">Kurono<div class="glyphicon glyphicon-chevron-right"></div></a>
                    </div>
                </div>
            {% else %}
                <button class="button--menu__item button--menu__item--sub-header"
                        data-toggle="collapse" data-target="#student-tabs">Student</button>
                <div id="student-tabs" class="collapse">
                    <button class="button--menu__item button--menu__item--student button--menu__item--sub-header"
                            data-toggle="collapse" data-target="#games-tabs">My Games</button>
                    <div id="games-tabs" class="collapse">
                        <a class="button button--menu__item button--menu__item--student button--menu__item__sub"
                          href="{% url 'levels' %}">Rapid Router<div class="glyphicon glyphicon-chevron-right"></div></a>
                        {% if not user|is_independent_student %}
                            <a class="button button--menu__item button--menu__item--student button--menu__item__sub"
                              href="{% url_for_aimmo_dashboard %}">Kurono<div class="glyphicon glyphicon-chevron-right"></div></a>
                        {% endif %}
                    </div>
                    <button class="button--menu__item button--menu__item--student button--menu__item--sub-header"
                            data-toggle="collapse" data-target="#scoreboards-tabs">View Scoreboards</button>
                    <div id="scoreboards-tabs" class="collapse">
                        <a class="button button--menu__item button--menu__item--student button--menu__item__sub"
                          href="{% url 'scoreboard' %}">Rapid Router<div class="glyphicon glyphicon-chevron-right"></div></a>
                    </div>
                {% if not user.new_student.class_field %}
                    <a class="button button--menu__item button--menu__item--student"
                      href="{% url 'student_join_organisation' %}">Join a school<div class="glyphicon glyphicon-chevron-right"></div></a>
                {% endif %}
                </div>
            {% endif %}
        {% else %}
            <a class="button button--menu__item button--menu__item--teacher"
              href="{% url 'register' %}">Register now<div class="glyphicon glyphicon-chevron-right"></div></a>
            <button class="button--menu__item button--menu__item--navigation button--menu__item--sub-header"
                    data-toggle="collapse" data-target="#login-tabs">Log in</button>
            <div id="login-tabs" class="collapse">
                <a class="button button--menu__item button--menu__item--teacher button--menu__item__sub"
                  href="{% url 'teacher_login' %}">Teacher<div class="glyphicon glyphicon-chevron-right"></div></a>
                <a class="button button--menu__item button--menu__item--student button--menu__item__sub"
                  href="{% url 'student_login' %}">Student<div class="glyphicon glyphicon-chevron-right"></div></a>
                <a class="button button--menu__item button--menu__item--independent button--menu__item__sub"
                  href="{% url 'independent_student_login' %}">Independent<div class="glyphicon glyphicon-chevron-right"></div></a>
            </div>
            <a class="button button--menu__item" href="{% url 'teach' %}">Teacher
                <div class="glyphicon glyphicon-chevron-right"></div></a>
            <a class="button button--menu__item" href="{% url 'play' %}">Student
                <div class="glyphicon glyphicon-chevron-right"></div></a>
        {% endif %}
        <a class="button button--menu__item" href="{% url 'about' %}">About
            <div class="glyphicon glyphicon-chevron-right"></div></a>
        <a class="button button--menu__item" href="{% url 'help' %}">Help and support
            <div class="glyphicon glyphicon-chevron-right"></div></a>
        <a class="button button--menu__item" href="{% url 'terms' %}">Terms of use
            <div class="glyphicon glyphicon-chevron-right"></div></a>
        <a class="button button--menu__item" href="{% url 'privacy_policy' %}">Privacy policy
            <div class="glyphicon glyphicon-chevron-right"></div></a>
        {% if user|is_logged_in %}
            {% if user|is_logged_in_as_teacher %}
                <a class="button button--menu__item" href="{% url 'dashboard' %}#account">Change password
                    <div class="glyphicon glyphicon-chevron-right"></div></a>
                <a class="button button--menu__item" href="{% url 'dashboard' %}#password">Update my details
                    <div class="glyphicon glyphicon-chevron-right"></div></a>
            {% endif %}
            <a class="button button--menu__item" href="{% url 'logout_view' %}">Logout
                <div class="glyphicon glyphicon-chevron-right"></div></a>
        {% endif %}
    </div>
</div>
