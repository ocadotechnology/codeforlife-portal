{% load staticfiles %}
{% load app_tags %}

<div id="carouselCards" class="carousel carousel-cards slide" data-ride="carousel" data-interval="false">
    <div class="carousel-inner" role="listbox">
        {% for card in cards %}
            <div class="item col-sm-4 {% if forloop.first %}active{% endif %}">
                <div class="card">
                    <div class="card__images">
                        <img class="card__image" src="{{ card.image | cloud_storage }}">
                    </div>
                    <div class="card__text">
                        <h5 class="card__title">{{ card.title }}</h5>
                        {% if card.description %}
                            <p>{{ card.description }}</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    <div class="carousel-nav text-center">
        <a class="button prev disabled" data-target="#carouselCards" data-slide="prev">
            <span class="iconify" data-icon="mdi:chevron-left" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="button next" data-target="#carouselCards" data-slide="next">
            <span class="iconify" data-icon="mdi:chevron-right" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>
</div>

<script>
    $('#carouselCards').on('slide.bs.carousel', function (event) {
        let cardIndex = $(event.relatedTarget).index();
        let indexLimit = {{ cards | length }} - 3;
        console.log(cardIndex, indexLimit);
        if (cardIndex === 0) {
            $('.carousel-nav > .prev').addClass('disabled');
        }
        else {
            $('.carousel-nav > .prev').removeClass('disabled');
        }
        if (cardIndex >= 2) {
            $('.carousel-nav > .next').addClass('disabled');
        }
        else {
            $('.carousel-nav > .next').removeClass('disabled');
        }
    })
</script>
